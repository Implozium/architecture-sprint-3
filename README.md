# Проект

## Задание 1

### Подзадание 1.1

Функциональность приложения:
- **Управление отоплением**:
  - Пользователи могут удалённо включать/выключать отопление в своих домах.
  - Пользователи могут устанавливать желаемую температуру.
  - Система автоматически поддерживает заданную температуру, регулируя подачу тепла.
- **Мониторинг температуры**:
  - Система получает данные о температуре с датчиков, установленных в домах.
  - Пользователи могут просматривать текущую температуру в своих домах через веб-интерфейс.

Архитектура монолитного приложения:
- Язык программирования: Java
- База данных: PostgreSQL
- Архитектура: Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения.
- Взаимодействие: Синхронное, запросы обрабатываются последовательно.
- Масштабируемость: Ограничена, так как монолит сложно масштабировать по частям.
- Развертывание: Требует остановки всего приложения.

Домены и границы контекстов:
- домен **управление устройствами** состоит из:
  - **функций**:
    - взаимодействие с устройствами;
    - хранение информации об устройствах;
  - **процессов**:
    - получения приложением показаний с датчиков устройств;
    - управление через приложение параметрами устройств;
  - **определений**:
    - **устройство** - состоит из датчика, который передает свои показания и исполнительного устройства, через которое устройство управляется;
    - **модуля управления** - устройство, которое управляет группой подключенных устройств;
    - **приложение** - состоит из хранения информации об устройствах, получения информации из устройств и управления устройствами;
- домен **управление телеметрией** состоит из:
  - **функций**:
    - хранение показаний с устройств;
  - **процессов**:
    - агрегация и храние показаний с датчиков устройств;
  - **определений**:
    - **показание устройства** - состоит из телеметрии от датчика;
- домен **взамодействие с пользоватлем** состоит из:
  - **функций**:
    - взаимодействие пользователем с приложением;
    - отображения информации об устройствах пользователей;
  - **процессов**:
    - отображение показаний с датчиков устройств через приложение;
    - внесение новых параметров устройств через приложение;
  - **определений**:
    - **устройство** - устройство пользователя, которое уравляется через приложение или модуль управления;
    - **модуля управления** - устройство, которое управляет группой подключенных устройств;
    - **приложения** - состоит из отображения информации об устройствах, модулях управления и управления устройствами пользователя;
    - **дом** - определенное метоположение для группировки устройств;
    - **пользователь** - клиент у которого утановлены устройства;

C4: Диаграмма контекста: [link](./docs/diagrams/src/context/context.puml)

### Подзадание 1.2

На основе доменов были выделины микросервисы:
- микросервис **по управлению устройствами**;
- микросервис **по управлению телеметрией устройств**;
- микросервис **по управлению данными клиентов**;

C4: Диаграмма контейнеров: [link](./docs/diagrams/src/container/container.puml)

C4: Диаграмма компонентов для контейнера "API Gateway": [link](./docs/diagrams/src/component/gateway_component.puml)

C4: Диаграмма компонентов для контейнера "Микросервис по устройствами": [link](./docs/diagrams/src/component/devices_component.puml)

C4: Диаграмма компонентов для контейнера "Микросервис по хранение телеметрии": [link](./docs/diagrams/src/component/telemetries_component.puml)

C4: Диаграмма компонентов для контейнера "Микросервис управлению данными клиентов": [link](./docs/diagrams/src/component/clients_component.puml)

### Подзадание 1.3

Основные сущности:
- **тип устройства** (DeviceType) - описывает тип устройства и его параметры по умолчанию;
- **устройство** (Device) - описывает устройство и его текущие параметры и статус, имеет связь с типом устройства, модулем, пользователем и домом;
- **модуль** - описывает модуль управления приборами, имеет связь с домом и пользователем;
- **дом** - описывает определенное местоположение, имеет связь с пользователем;
- **пользователь** - описывает клиента - владельца модулей и устройств;

ER Диаграмма: [link](./docs/diagrams/src/er.puml)

### Подзадание 1.4

Для входящих сообщений через API Gateway используется REST, а уже API Gateway вызывает запросы синхронно через REST для операций чтения или асинхронно через AsyncAPI для операций модификации.

OpenAPI для контейнера "API Gateway": [link](./docs/api/openapi.yaml)

OpenAPI для контейнера "Микросервис по устройствами": [link](./docs/api/devices-openapi.yaml)

OpenAPI для контейнера "Микросервис по хранение телеметрии": [link](./docs/api/telemetries-openapi.yaml)

OpenAPI для контейнера "Микросервис управлению данными клиентов": [link](./docs/api/clients-openapi.yaml)

AsyncAPI общий для сервисов: [link](./docs/api/asyncapi.yaml)

## Запуск проекта

`docker compose up -d`

`sh init.sh`

`http://localhost:8080/` - будет запущен swagger-ui для gateway в котором работают методы для devices / telemetries.
